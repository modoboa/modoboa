<?xml version="1.0" encoding="UTF-8"?>
<Autodiscover xmlns="http://schemas.microsoft.com/exchange/autodiscover/responseschema/2006">
  <Response xmlns="http://schemas.microsoft.com/exchange/autodiscover/outlook/responseschema/2006a">
    <Account>
      <AccountType>email</AccountType>
      <Action>settings</Action>

      <Protocol>
        <Type>IMAP</Type>
        <Server>{{ connection_settings.imap.HOSTNAME }}</Server>
        <Port>{{ connection_settings.imap.PORT }}</Port>
        {% if connection_settings.imap.SOCKET_TYPE|upper == "SSL" %}
        <SSL>true</SSL>
        <TLS>false</TLS>
        {% elif connection_settings.imap.SOCKET_TYPE|upper == "STARTTLS" %}
        <SSL>false</SSL>
        <TLS>true</TLS>
        {% elif connection_settings.imap.SOCKET_TYPE|lower == "plain" %}
        <SSL>false</SSL>
        <TLS>false</TLS>
        {% endif %}
        <LoginName>{{ emailaddress }}</LoginName>
      </Protocol>

      <Protocol>
        <Type>SMTP</Type>
        <Server>{{ connection_settings.smtp.HOSTNAME }}</Server>
        <Port>{{ connection_settings.smtp.PORT }}</Port>
        {% if connection_settings.smtp.SOCKET_TYPE|upper == "SSL" %}
        <SSL>true</SSL>
        <TLS>false</TLS>
        {% elif connection_settings.smtp.SOCKET_TYPE|upper == "STARTTLS" %}
        <SSL>false</SSL>
        <TLS>true</TLS>
        {% endif %}
        <LoginName>{{ emailaddress }}</LoginName>
      </Protocol>

    </Account>
  </Response>
</Autodiscover>
